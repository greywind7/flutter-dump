import 'dart:async';

class Cake {}
class Order {
	String type;
	Order(this.type);
}

void main() {
	final controller = new StreamController(); // gives us a sink and a stream 
	// sink takes data and passes it off to a stream 

	final order = new Order("Cherry");

	final baker = new StreamTransformer.fromHandlers(
		handleData: (cakeType, sink) {
			if(cakeType == "chocolate") {
				sink.add(new Cake());
			} else {
				sink.addError("Nuh huh cant do that");
			}
		}
	);

	controller.sink.add(order); // passes data to the stream 

	controller.stream
		.map((order) => order.type) // takes a function and does some processing with it
		.transform(baker)
		.listen(
			(cake) => print("Here you go"),
			onError: (err) => print(err)
		);
}